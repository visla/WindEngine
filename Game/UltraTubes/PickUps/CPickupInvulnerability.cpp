/*
	Filename:	CPickupInvulnerability.cpp
	Author:		Goran Bogdanovic
*/


#include <CPickupInvulnerability.h>
#include <ActorTags.h>
#include <CPickupActionInvulnerability.h>


CPickupInvulnerability::CPickupInvulnerability()
{
	ModelName = "PickUps.Models.Invulnerability";
	NewPreset = 0;
	Type = PICKUPTYPE_INVULNERABILITY;
}

CPickupInvulnerability::~CPickupInvulnerability()
{
}


void CPickupInvulnerability::OnTrigger(WeActor* ByObject)
{
	if (ByObject->Type == ACTORTYPE_TUBER)
	{
		CTuber* Tuber = (CTuber*)ByObject;

		bool Found = false;

		for (Tuber->PickupActions.First(); !Tuber->PickupActions.End(); Tuber->PickupActions.Next())
		{
			if (Tuber->PickupActions.GetItem()->GetActionType() == PickupActionInvulnerability)
			{
				CPickupActionInvulnerability* PickupAction = (CPickupActionInvulnerability*)Tuber->PickupActions.GetItem();
                PickupAction->Timer = 0.0f;
				PickupAction->Validity = true;
				Found = true;
				break;
			}
		}

		if (!Found)
		{
			Tuber->PickupActions.PushBack(new CPickupActionInvulnerability());
		}
	}

	CPickUp::OnTrigger(ByObject);
}
